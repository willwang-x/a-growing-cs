# Domain-Driven Design 
	
	
## To do 	
- [] 再深入阅读 [领域驱动架构（DDD）建模中的模型到底是什么？ - dz902的回答 - 知乎](https://www.zhihu.com/question/25089273/answer/233316164) 
	
## Let's talk 
	
* 一，爱学习的程序员+业务专家才能做**出健壮易维护**的系统。
* 二，减少沟通成本的好方法是都用**同样**的词语。
* 三，任何词语都能找到不止一个上下文，脱离上下文任何一个词语都有歧义。
* “DDD is about designing software based on models of the underlying domain” — Martin Fowler [?]
* DDD是更高层次的设计理念的一种**方法论**，而不是具体的开发层次的。DDD是Domain-driven design，而TDD是test-driven development。所以，每次看到有人总是试图比较TDD和DDD，我觉得有时候挺可笑。 —— [如何评价领域驱动设计（DDD）？ - 大潘儿的回答 - 知乎](https://www.zhihu.com/question/43554974/answer/316393242)
	
## Why DDD become hot again?
	
十几年来DDD一直都不温不火，不过随着最近**微服务**火起来，我们发现DDD的Bounded context概念特别有利于识别微服务，可以作为划分服务的一种依据，所以现在又重新火起来了。
	
## Why DDD may fail?
	
本质上说是一种模型驱动开发的方法论。但是由于没有好的保持模型和代码一致的办法，所以往往开始搞的不错，慢慢的就不一致了，也就逐渐烂掉了。
	
## Example 
	
### 通过“客户买手机“来理解DDD
	
[领域驱动架构（DDD）建模中的模型到底是什么？ - dz902的回答 - 知乎](https://www.zhihu.com/question/25089273/answer/233316164) : 要回答这个问题，需要三步走：

* 为什么要建模；
* 怎么建模才合理；
* “领域”模型具体指什么。特别好的一个入门。
	
#### 故事：

客户在专卖店买了个手机，留下了自己的名字和电话，店员做了记录。客人来时，只要店员能在记录里查到客人名字和电话的订单，就说明客人曾经买过手机。

#### Why? 

* 建模本质上是一种抽象。抽象就是归类，其目的是减轻认知的负担，避免重复的思考和工作，提升人的计算能力。所以，“通用”是建模的第一步，接下来我们还需要“复用”建好的模型。
* 第一，要把心智模型提取出来，显性化，让不同的人对业务的理解达成一致；第二，要归类复用，避免重复的工作，让人可以关注更高层面的事务。 e.g. 订单 = 客户 + 商品信息

#### How? 

* 判断模型好坏的重要依据是它的**使用效率**（扩展度、灵活度、与组织的对应度），所以建模的合理性也围绕这个来展开。 DDD 把业务分成 UI、应用、领域、基建四层。
* 分类的依据是：越往上，预期变动越频繁；越往下，预期变动越少。

#### What? 

* 按 DDD 的定义，**领域模**型应该捕捉**“业务规则”**或者**“领域逻辑”**（business rules / domain logic），而应用模型则捕捉**“应用逻辑”**（application logic）。
* 如果是一个实体（entity）和针对实体的增删改查，就属于领域层；如果是一个场景， 比如出现在 UI 菜单上的选项，就属于应用层。
* 比如：账单，用户，编辑商品，编辑库存，这些是领域层；“购买商品”，则是应用层。

#### 总结：

* DDD 把业务分成 UI、应用、领域、基建四层，其核心是**高度提纯、通用、少变化**的领域层，是谓“领域驱动”；
* 领域层中包含领域模型，捕捉领域逻辑，暴露出接口用于操作领域模型，这些接口提供的操作可以确保领域是自洽的；
* 领域模型既是业务描述，又是代码实现的结构设计，二者的结合点在于公开出来的界面、接口。
	
### 美团实践经验: 抽奖平台

我们将通过上文提到的抽奖平台，来详细介绍我们如何通过DDD来解构一个中型的基于微服务架构的系统，从而做到系统的高内聚、低耦合。
	
### ThoughtWorks: "这就是我们之前那个工作流系统"?

从互联网架构我们可以学到什么呢？从架构设计角度我认为以下三点是关键。
	
1. 让我们的组件划分**尽量靠近变化**的原点，对于互联网来说就是用户和业务，这样的划分能够让我们将变化“隔离”在一定的范围（组件）内，从而帮助我们**有效减少改变点**。
1. 组件之间能够**互相调用**，但彼此之间不应该有强依赖，即各自完成的业务是相对独立的，不会因为一方掉线而牵连另外一方，比如新闻网站挂掉了，聊天网站应该继续正常提供服务，可能提示用户暂时无法提供新闻信息而已。
1. 组件在业务上是**鼓励复用**的，正是这样的复用才成就了今天的互联网，我们不会每个网站都去实现一个强大的搜索引擎。而被“复用”最多的网站显然会受到追捧，成为明星业务。当然架构上这样的网站必然是健壮的。
	
## Reference:
	
* [如何评价评价领域驱动设计](https://www.zhihu.com/question/43554974)
* [领域驱动架构（DDD）建模中的模型到底是什么？](https://www.zhihu.com/question/25089273)
* [领域驱动设计在互联网业务开发中的实践](https://zhuanlan.zhihu.com/p/30877742)
* [Software development practice： Domain Storytelling  Domain-Driven Design ](http://www.domainstorytelling.org/)